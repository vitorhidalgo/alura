{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_ordemAtual","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","BindHelper","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_service","NegociacaoService","_init","lista","catch","console","log","erro","texto","setInterval","importaNegociacoes","event","preventDefault","negociacao","_criarNegociacao","cadastra","then","adiciona","mensagem","_limpaFormulario","importa","negociacoes","forEach","apaga","esvazia","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus","coluna","inverterOrdem","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController \r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\r\n\t\tthis._ordemAtual = '';\r\n\t\tthis._inputData       = $('#data');\r\n\t\tthis._inputQuantidade = $('#quantidade');\r\n\t\tthis._inputValor      = $('#valor');\r\n\r\n\t\tthis._listaNegociacoes = new BindHelper\r\n\t\t(\r\n\t\t\tnew ListaNegociacoes(), \r\n\t\t\tnew NegociacoesView($('#negociacoesView')), \r\n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverterOrdem'\r\n\t\t);\r\n\t\t\r\n\t\tthis._mensagem = new BindHelper\r\n\t\t(\r\n\t\t\tnew Mensagem(),\r\n\t\t\tnew MensagemView($('#mensagemView')),\r\n\t\t\t'texto'\r\n\t\t);\r\n\r\n\t\tthis._ordemAtual = '';\r\n\t\tthis._service = new NegociacaoService();\r\n\t\t\r\n\t\tthis._init();\r\n\t};\r\n\r\n\t_init()\r\n\t{\r\n\t\tthis._service\r\n\t\t\t.lista()\r\n\t\t\t.catch\r\n\t\t\t(\r\n\t\t\t\terro => \r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(erro);\r\n\t\t\t\t\tthis._mensagem.texto = erro;\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\tsetInterval\r\n\t\t(\r\n\t\t\t() => \r\n\t\t\t{\r\n\t\t\t\tthis.importaNegociacoes();\r\n\t\t\t}, \r\n\t\t\t3000\r\n\t\t);\r\n\t};\r\n\t\r\n\tadiciona(event)\r\n\t{\r\n\t\tevent.preventDefault();\r\n\r\n\t\tlet negociacao = this._criarNegociacao();\r\n\r\n\t\tthis._service\r\n\t\t\t.cadastra(negociacao)\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._limpaFormulario();\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t};\r\n\r\n\timportaNegociacoes() \r\n\t{\r\n\t\tthis._service\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n\t\t\t.then\r\n\t\t\t(\r\n\t\t\t\tnegociacoes => negociacoes.forEach\r\n\t\t\t\t(\r\n\t\t\t\t\tnegociacao => \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\t\t\tthis._mensagem.texto = 'Negociações do período importadas';\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t};\r\n\r\n\tapaga()\r\n\t{\r\n\t\tthis._service\r\n\t\t\t.apaga()\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._listaNegociacoes.esvazia();\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t};\r\n\r\n\t_criarNegociacao()\r\n\t{\r\n\t\treturn new Negociacao\r\n\t\t(\r\n\t\t\tDateHelper.textoParaData(this._inputData.value),\r\n\t\t\tparseInt(this._inputQuantidade.value),\r\n\t\t\tparseFloat(this._inputValor.value)\r\n\t\t);\r\n\t};\r\n\r\n\t_limpaFormulario()\r\n\t{\r\n\t\tthis._inputData.value = '';\r\n\t\tthis._inputQuantidade.value = 1;\r\n\t\tthis._inputValor.value = 0.0;\r\n\t\tthis._inputData.focus();\r\n\t};\r\n\r\n\tordena(coluna)\r\n\t{\r\n\t\tif(this._ordemAtual === coluna)\r\n\t\t{\r\n\t\t\tthis._listaNegociacoes.inverterOrdem();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\t\tthis._ordemAtual = coluna;\r\n\t};\r\n}"]}