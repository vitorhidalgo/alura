{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","BindHelper","Negociacao","NegociacaoController","$","document","querySelector","bind","_ordemAtual","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_service","_init","lista","catch","console","log","erro","texto","setInterval","importaNegociacoes","event","preventDefault","negociacao","_criarNegociacao","cadastra","then","adiciona","mensagem","_limpaFormulario","importa","negociacoes","forEach","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus","coluna","inverterOrdem","ordena","a","b","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\r\nimport {Mensagem} from '../models/Mensagem';\r\nimport {NegociacoesView} from '../views/NegociacoesView';\r\nimport {MensagemView} from '../views/MensagemView';\r\nimport {NegociacaoService} from '../services/NegociacaoService';\r\nimport {DateHelper} from '../helpers/DateHelper';\r\nimport {BindHelper} from '../helpers/BindHelper';\r\nimport {Negociacao} from '../models/Negociacao';\r\n\r\nexport class NegociacaoController \r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\r\n\t\tthis._ordemAtual = '';\r\n\t\tthis._inputData       = $('#data');\r\n\t\tthis._inputQuantidade = $('#quantidade');\r\n\t\tthis._inputValor      = $('#valor');\r\n\r\n\t\tthis._listaNegociacoes = new BindHelper\r\n\t\t(\r\n\t\t\tnew ListaNegociacoes(), \r\n\t\t\tnew NegociacoesView($('#negociacoesView')), \r\n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverterOrdem'\r\n\t\t);\r\n\t\t\r\n\t\tthis._mensagem = new BindHelper\r\n\t\t(\r\n\t\t\tnew Mensagem(),\r\n\t\t\tnew MensagemView($('#mensagemView')),\r\n\t\t\t'texto'\r\n\t\t);\r\n\r\n\t\tthis._ordemAtual = '';\r\n\t\tthis._service = new NegociacaoService();\r\n\t\t\r\n\t\tthis._init();\r\n\t};\r\n\r\n\t_init()\r\n\t{\r\n\t\tthis._service\r\n\t\t\t.lista()\r\n\t\t\t.catch\r\n\t\t\t(\r\n\t\t\t\terro => \r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(erro);\r\n\t\t\t\t\tthis._mensagem.texto = erro;\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\tsetInterval\r\n\t\t(\r\n\t\t\t() => \r\n\t\t\t{\r\n\t\t\t\tthis.importaNegociacoes();\r\n\t\t\t}, \r\n\t\t\t3000\r\n\t\t);\r\n\t};\r\n\t\r\n\tadiciona(event)\r\n\t{\r\n\t\tevent.preventDefault();\r\n\r\n\t\tlet negociacao = this._criarNegociacao();\r\n\r\n\t\tthis._service\r\n\t\t\t.cadastra(negociacao)\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._limpaFormulario();\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t};\r\n\r\n\timportaNegociacoes() \r\n\t{\r\n\t\tthis._service\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n\t\t\t.then\r\n\t\t\t(\r\n\t\t\t\tnegociacoes => negociacoes.forEach\r\n\t\t\t\t(\r\n\t\t\t\t\tnegociacao => \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\t\t\tthis._mensagem.texto = 'Negociações do período importadas';\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t};\r\n\r\n\tapaga()\r\n\t{\r\n\t\tthis._service\r\n\t\t\t.apaga()\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._listaNegociacoes.esvazia();\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t};\r\n\r\n\t_criarNegociacao()\r\n\t{\r\n\t\treturn new Negociacao\r\n\t\t(\r\n\t\t\tDateHelper.textoParaData(this._inputData.value),\r\n\t\t\tparseInt(this._inputQuantidade.value),\r\n\t\t\tparseFloat(this._inputValor.value)\r\n\t\t);\r\n\t};\r\n\r\n\t_limpaFormulario()\r\n\t{\r\n\t\tthis._inputData.value = '';\r\n\t\tthis._inputQuantidade.value = 1;\r\n\t\tthis._inputValor.value = 0.0;\r\n\t\tthis._inputData.focus();\r\n\t};\r\n\r\n\tordena(coluna)\r\n\t{\r\n\t\tif(this._ordemAtual === coluna)\r\n\t\t{\r\n\t\t\tthis._listaNegociacoes.inverterOrdem();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\t\tthis._ordemAtual = coluna;\r\n\t};\r\n}\r\n\r\nlet negociacaoController = new NegociacaoController();\r\nexport function currentInstance()\r\n{\r\n\treturn negociacaoController;\r\n}"]}